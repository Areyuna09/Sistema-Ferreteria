<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>

<BorderPane xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.ferreteria.controllers.UsersController" styleClass="dashboard-root">

    <!-- Navbar Superior -->
    <top>
        <fx:include fx:id="navbar" source="components/Navbar.fxml"/>
    </top>

    <!-- Contenido Principal -->
    <center>
        <ScrollPane fitToWidth="true" fitToHeight="true" styleClass="scroll-pane">
            <HBox spacing="24">
                <padding>
                    <Insets top="32" right="40" bottom="32" left="40"/>
                </padding>

                <!-- Panel Izquierdo: Formulario -->
                <VBox spacing="20" prefWidth="350" styleClass="form-panel">
                    <padding>
                        <Insets top="20" right="20" bottom="20" left="20"/>
                    </padding>

                    <!-- Titulo del Formulario -->
                    <Label fx:id="formTitle" text="Nuevo Usuario" styleClass="section-title"/>

                    <!-- Campo: Username -->
                    <VBox spacing="6">
                        <Label text="Nombre de Usuario" styleClass="field-label"/>
                        <TextField fx:id="usernameField" promptText="Ingrese username..." styleClass="form-field"/>
                    </VBox>

                    <!-- Campo: Nombre Completo -->
                    <VBox spacing="6">
                        <Label text="Nombre Completo" styleClass="field-label"/>
                        <TextField fx:id="fullNameField" promptText="Nombre y apellido..." styleClass="form-field"/>
                    </VBox>

                    <!-- Campo: Password -->
                    <VBox spacing="6">
                        <Label text="Contraseña" styleClass="field-label"/>
                        <StackPane>
                            <PasswordField fx:id="passwordField" promptText="Minimo 6 caracteres..." styleClass="form-field"/>
                            <TextField fx:id="passwordVisible" promptText="Minimo 6 caracteres..." styleClass="form-field" visible="false"/>
                        </StackPane>
                    </VBox>

                    <!-- Campo: Confirmar Password -->
                    <VBox spacing="6">
                        <Label text="Confirmar Contraseña" styleClass="field-label"/>
                        <StackPane>
                            <PasswordField fx:id="confirmPasswordField" promptText="Repetir contraseña..." styleClass="form-field"/>
                            <TextField fx:id="confirmPasswordVisible" promptText="Repetir contraseña..." styleClass="form-field" visible="false"/>
                        </StackPane>
                        <CheckBox fx:id="showPasswordCheck" text="Mostrar contraseñas"/>
                    </VBox>

                    <!-- Campo: Rol -->
                    <VBox spacing="6">
                        <Label text="Rol" styleClass="field-label"/>
                        <ComboBox fx:id="roleCombo" prefWidth="300" styleClass="form-field"/>
                    </VBox>

                    <!-- Mensaje de Error/Info -->
                    <Label fx:id="messageLabel" wrapText="true" styleClass="message-label"/>

                    <!-- Botones -->
                    <HBox spacing="12" alignment="CENTER">
                        <Button text="Guardar" onAction="#handleSave" styleClass="action-button, success" prefWidth="100"/>
                        <Button text="Limpiar" onAction="#handleClear" styleClass="action-button, primary" prefWidth="100"/>
                        <Button fx:id="btnDelete" text="Eliminar" onAction="#handleDelete" styleClass="action-button, danger" prefWidth="100" visible="false"/>
                    </HBox>
                </VBox>

                <!-- Panel Derecho: Tabla -->
                <VBox spacing="16" HBox.hgrow="ALWAYS">
                    <!-- Header -->
                    <HBox alignment="CENTER_LEFT" spacing="20">
                        <VBox HBox.hgrow="ALWAYS" spacing="6">
                            <Label text="Gestion de Usuarios" styleClass="page-title"/>
                            <Label text="Administra los usuarios del sistema" styleClass="page-subtitle"/>
                        </VBox>
                    </HBox>

                    <!-- Barra de busqueda -->
                    <HBox spacing="12" alignment="CENTER_LEFT">
                        <TextField fx:id="searchField" promptText="Buscar por username..." prefWidth="300" styleClass="search-field"/>
                        <Button text="Buscar" onAction="#handleSearch" styleClass="action-button, primary"/>
                        <Button text="Limpiar Busqueda" onAction="#handleClearSearch" styleClass="action-button"/>
                    </HBox>

                    <!-- Tabla de usuarios -->
                    <TableView fx:id="usersTable" VBox.vgrow="ALWAYS" styleClass="full-width-table">
                        <columns>
                            <TableColumn fx:id="colId" prefWidth="60" text="ID"/>
                            <TableColumn fx:id="colUsername" prefWidth="150" text="Username"/>
                            <TableColumn fx:id="colFullName" prefWidth="200" text="Nombre Completo"/>
                            <TableColumn fx:id="colRole" prefWidth="120" text="Rol"/>
                            <TableColumn fx:id="colCreatedAt" prefWidth="150" text="Fecha Creacion"/>
                            <TableColumn fx:id="colStatus" prefWidth="80" text="Estado"/>
                        </columns>
                        <columnResizePolicy>
                            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                        </columnResizePolicy>
                    </TableView>
                </VBox>
            </HBox>
        </ScrollPane>
    </center>

</BorderPane>
